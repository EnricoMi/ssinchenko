<!DOCTYPE html>
<html lang="en" dir="auto">

<head>
	<meta name="generator" content="Hugo 0.127.0"><script src="/ssinchenko/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=ssinchenko/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Sem Sinchenko</title>

<meta name="description" content="My private blog">
<meta name="author" content="Sem Sinchenko">
<link rel="canonical" href="http://localhost:1313/ssinchenko/">
<link crossorigin="anonymous" href="/ssinchenko/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/ssinchenko/images/fav/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/ssinchenko/images/fav/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/ssinchenko/images/fav/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/ssinchenko/images/fav/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/ssinchenko/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/ssinchenko/index.xml">
<link rel="alternate" type="application/json" href="http://localhost:1313/ssinchenko/index.json">
<link rel="alternate" hreflang="en" href="http://localhost:1313/ssinchenko/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>















    
        <link rel="preconnect" href="https://plausible.io">
    <!-- Dev mode : We do not load plausible script to avoid bloating your stats -->

<!-- If you are using Content-Security-Policy, do not forget to add this code to your CSP : 
  script-src 'unsafe-inline' https://plausible.io
  connect-src 'unsafe-inline' https://plausible.io
  or just add the partial 'plausible_csp.html' to those 2 csp directives in your 'index.headers' file
-->



    
    <script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
    <script>
         
         
         
    </script>

    


  

<meta property="og:title" content="" />
<meta property="og:description" content="My private blog" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://localhost:1313/ssinchenko/" />
<meta property="og:image" content="http://localhost:1313/ssinchenko/images/avatar-favicon.png" />


<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/ssinchenko/images/avatar-favicon.png" />
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="My private blog"/>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Sem Sinchenko",
  "url": "http://localhost:1313/ssinchenko/",
  "description": "My private blog",
  "thumbnailUrl": "http://localhost:1313/ssinchenko/images/fav/favicon.ico",
  "sameAs": [
      "https://github.com/SemyonSinchenko", "https://www.linkedin.com/in/semyon-a-sinchenko/", "https://pixelfed.social/i/web/profile/391519829850111071", "https://semyonsinchenko.github.io/ssinchenko/index.xml", "mailto:ssinchenko@apache.org"
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/ssinchenko/" accesskey="h" title="Sem Sinchenko (Alt + H)">Sem Sinchenko</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/ssinchenko/" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/ssinchenko/page/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/ssinchenko/page/cv/" title="CV">
                    <span>CV</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/ssinchenko/categories" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/ssinchenko/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<article class="first-entry home-info">
    <header class="entry-header">
        <h1>Welcome to my Blog!</h1>
    </header>
    <div class="entry-content">
        <p>ðŸ‘‹ðŸ‘‹ðŸ‘‹ Welcome to my personal blog!</p>
<p>I&rsquo;m a Russian-born data engineer living in Belgrade, Serbia since 2022.</p>
<p>My blog contains the context mostly about three topics:</p>
<ol>
<li>My exploration of modern data stack and selected engineering topics such as Python/JVM development, Apache Spark, etc.</li>
<li>Stories about my contribution to OSS projects</li>
<li>Reports from my personal bikepacking tours</li>
</ol>
<p>About any questions related to this blog you can contact me via email: <a href="mailto:ssinchenko@apache.org">ssinchenko@apache.org</a></p>

    </div>
    <footer class="entry-footer">
        <div class="social-icons" >
    <a href="https://github.com/SemyonSinchenko" target="_blank" rel="noopener noreferrer me"
        title="My GitHub Profile">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
    </a>
    <a href="https://www.linkedin.com/in/semyon-a-sinchenko/" target="_blank" rel="noopener noreferrer me"
        title="My LinkedIn Profile">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
    <rect x="2" y="9" width="4" height="12"></rect>
    <circle cx="4" cy="4" r="2"></circle>
</svg>
    </a>
    <a href="https://pixelfed.social/i/web/profile/391519829850111071" target="_blank" rel="noopener noreferrer me"
        title="My Pixelfed With Selected Photos">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path id="pixelfed"
        d="m12 .99649c-6.077 0-11.004 4.9264-11.004 11.004 0 6.077 4.9264 11.004 11.004 11.004 6.077 0 11.004-4.9264 11.004-11.004 0-6.077-4.9264-11.004-11.004-11.004zm-1.7683 6.7017h2.9133c1.9016 1e-6 3.4428 1.5006 3.4428 3.3518 0 1.8512-1.5414 3.3526-3.4428 3.3526h-2.0185l-2.8816 2.756v-7.5262c0-1.068.8896-1.9342 1.9867-1.9342z"
        fill="none" stroke="currentColor" stroke-width="1.993" />
</svg>
    </a>
    <a href="https://semyonsinchenko.github.io/ssinchenko/index.xml" target="_blank" rel="noopener noreferrer me"
        title="Atom/RSS Feed of This Blog">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
    </a>
    <a href="mailto:ssinchenko@apache.org" target="_blank" rel="noopener noreferrer me"
        title="Contact Me via Email">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 21" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
    <polyline points="22,6 12,13 2,6"></polyline>
</svg>
    </a>
</div>

    </footer>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="http://localhost:1313/ssinchenko/images/unitycatalog/unitycatalog.png" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Unitycatalog: the first look
    </h2>
  </header>
  <div class="entry-content">
    <p>Databricks recently open-sourced Unitycatlog, a unified data catalog that aims to provide a single source of truth for data discovery, governance, and access control across multiple systems. In this blog post, we take a first look at Unitycatlog and dive into the source code to explain which features from the announcement are actually present. We explore how Unitycatlog addresses the challenges of managing data in a complex data landscape and discuss its potential impact on simplifying data governance and improving data accessibility for organizations.</p>
  </div>
  <footer class="entry-footer"><span title='2024-06-17 16:00:00 +0200 CEST'>June 17, 2024</span>&nbsp;Â·&nbsp;7 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to Unitycatalog: the first look" href="http://localhost:1313/ssinchenko/post/uniticatalog-first-look/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="http://localhost:1313/ssinchenko/images/asof/fs_overview.png" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Effective asOfJoin in PySpark for Feature Store
    </h2>
  </header>
  <div class="entry-content">
    <p>Leveraging Time-Based Feature Stores for Efficient Data Science Workflows In our previous post, we briefly touched upon the concept of ML feature stores and their significance in streamlining machine learning workflows. Today, weâ€™ll again explore a specific type of feature store known as a time-based feature store, which plays a crucial role in handling temporal data and enabling efficient feature retrieval for data science tasks. In this post weâ€™ll how a feature-lookup problem may be effectively solved in PySpark using domain knowledge and understanding how Apache Spark works with partitions and columnar data formats....</p>
  </div>
  <footer class="entry-footer"><span title='2024-04-14 13:42:36 +0200 CEST'>April 14, 2024</span>&nbsp;Â·&nbsp;14 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to Effective asOfJoin in PySpark for Feature Store" href="http://localhost:1313/ssinchenko/post/fs_asof_problem_pyspark/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="http://localhost:1313/ssinchenko/images/feature_store/FS%20Diagram.drawio.png" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Computing ML Feature Store in PySpark
    </h2>
  </header>
  <div class="entry-content">
    <p>In this blog post, I will share my experience in building an ML Feature Store using PySpark. I will demonstrate how one can utilize case-when expressions to generate multiple aggregations with minimal data shuffling across the cluster. This approach is significantly more efficient than the naive method of using a combination of groupBy and pivot for generating aggregations (or features in ML terms).</p>
  </div>
  <footer class="entry-footer"><span title='2024-04-07 16:01:25 +0200 CEST'>April 7, 2024</span>&nbsp;Â·&nbsp;8 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to Computing ML Feature Store in PySpark" href="http://localhost:1313/ssinchenko/post/effective_feature_store_pyspark/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/f/f3/Apache_Spark_logo.svg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Extending Spark Connect
    </h2>
  </header>
  <div class="entry-content">
    <p>This blog post presents a very detailed step-by-step guide on how to create a SparkConnect protocol extension in Java and call it from PySpark. It will also cover a topic about how to define all the necessary proto3 messages for it. At the end of this guide you will have a way to interact with Spark JVM from PySpark almost like you can with py4j in a non-connect version.</p>
  </div>
  <footer class="entry-footer"><span title='2024-03-04 12:30:57 +0100 CET'>March 4, 2024</span>&nbsp;Â·&nbsp;22 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to Extending Spark Connect" href="http://localhost:1313/ssinchenko/post/extending-spark-connect/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/5/52/Apache_Maven_logo.svg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Supporting multiple Apache Spark versions with Maven
    </h2>
  </header>
  <div class="entry-content">
    <p>I recently had the opportunity to work on an open source project that implements a custom Apache Spark data source and associated logic for working with graph data. The code was written to work with Apache Spark 3.2.2. I am committed to extending support to multiple versions of Spark. In this blog post I want to show how the structure of such a project can be organized using Maven profiles.</p>
  </div>
  <footer class="entry-footer"><span title='2024-02-25 12:00:05 +0200 +0200'>February 25, 2024</span>&nbsp;Â·&nbsp;7 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to Supporting multiple Apache Spark versions with Maven" href="http://localhost:1313/ssinchenko/post/multiple-spark-versions-with-maven/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/6/63/Databricks_Logo.png" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">How Databricks Runtime 14.x destroyed 3d-party PySpark packages compatibility
    </h2>
  </header>
  <div class="entry-content">
    <p>In this post, I want to discuss the groundbreaking changes in the latest LTS release of the Databricks runtime. This release introduced Spark Connect as the default way to work with shared clusters. I will give a brief introduction to the topic of internal JVM calls and Spark Connect, provide examples of 3d-party OSS projects broken in 14.3, and try to understand the reasons for such a move by Databricks.</p>
  </div>
  <footer class="entry-footer"><span title='2024-02-22 14:00:05 +0200 +0200'>February 22, 2024</span>&nbsp;Â·&nbsp;10 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to How Databricks Runtime 14.x destroyed 3d-party PySpark packages compatibility" href="http://localhost:1313/ssinchenko/post/how-databricks-14x-breaks-3dparty-compatibility/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/f/f3/Apache_Spark_logo.svg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">PySpark column lineage
    </h2>
  </header>
  <div class="entry-content">
    <p>In this post, I will show you how to use information from the spark plan to track data lineage at the column level. This approach will also works with recently introduced SparkConnect.</p>
  </div>
  <footer class="entry-footer"><span title='2024-01-10 12:00:05 +0200 +0200'>January 10, 2024</span>&nbsp;Â·&nbsp;14 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to PySpark column lineage" href="http://localhost:1313/ssinchenko/post/pyspark-column-lineage/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/f/f3/Apache_Spark_logo.svg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">How to estimate a PySpark DF size?
    </h2>
  </header>
  <div class="entry-content">
    <p>Sometimes it is an important question, how much memory does our DataFrame use? And there is no easy answer if you are working with PySpark. You can try to collect the data sample and run local memory profiler. You can estimate the size of the data in the source (for example, in parquet file). But we will go another way and try to analyze the logical plan of Spark from PySpark. In case when we are working with Scala Spark API we are able to work with resolved or unresolved logical plans and physical plan via a special API. But from PySpark API only string representation is available and we will work with it.</p>
  </div>
  <footer class="entry-footer"><span title='2023-11-23 23:27:05 +0200 +0200'>November 23, 2023</span>&nbsp;Â·&nbsp;6 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to How to estimate a PySpark DF size?" href="http://localhost:1313/ssinchenko/post/estimation-spark-df-size/"></a>
</article>

<article class="post-entry"> 
<figure class="entry-cover"><img loading="lazy" src="http://localhost:1313/ssinchenko/images/eastern_serbia/DSC01498.jpg" alt="">
</figure>
  <header class="entry-header">
    <h2 class="entry-hint-parent">Cycling Eastern Serbia
    </h2>
  </header>
  <div class="entry-content">
    <p>I would like to tell you about my bicycle trip through Eastern Serbia. This part of the world is beautiful, but there is a big problem with lack of information in English. So I will try to fill this gap. The route I will describe starts in Belgrade, goes along the Danube River, through Djerdap National Park to the border with Serbia, and returns to Belgrade through Kucaj-Beljanica National Park.</p>
  </div>
  <footer class="entry-footer"><span title='2023-10-12 09:45:05 +0200 CEST'>October 12, 2023</span>&nbsp;Â·&nbsp;19 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to Cycling Eastern Serbia" href="http://localhost:1313/ssinchenko/post/cycling-eastern-serbia/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Using Pyenv with NixOS
    </h2>
  </header>
  <div class="entry-content">
    <p>The problem Recently I decided to switch from Ubuntu to NixOS. Do not ask me why, it was just for fun mostly. One of the main ideas behind NixOS is to separation of dependencies: each new package is installed into separate sandbox with own scope of dependencies. By design it should make system significantly more stable but sometimes there are problems. One of such problems I faced with pyenv â€“ a tool for simplifying python versions management....</p>
  </div>
  <footer class="entry-footer"><span title='2023-09-29 17:29:05 +0200 CEST'>September 29, 2023</span>&nbsp;Â·&nbsp;2 min&nbsp;Â·&nbsp;Sem Sinchenko</footer>
  <a class="entry-link" aria-label="post link to Using Pyenv with NixOS" href="http://localhost:1313/ssinchenko/post/using-pyenv-with-nixos/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="http://localhost:1313/ssinchenko/page/2/">Next&nbsp;&nbsp;Â»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/ssinchenko/">Sem Sinchenko</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
